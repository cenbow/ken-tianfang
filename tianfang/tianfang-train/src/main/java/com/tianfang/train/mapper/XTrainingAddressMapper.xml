<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianfang.train.mapper.XTrainingAddressMapper" >
  <resultMap id="BaseResultMap" type="com.tianfang.train.pojo.TrainingAddress" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Sep 02 10:44:01 CST 2015.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="district_id" property="districtId" jdbcType="VARCHAR" />
    <result column="place" property="place" jdbcType="VARCHAR" />
    <result column="longtitude" property="longtitude" jdbcType="DECIMAL" />
    <result column="latitude" property="latitude" jdbcType="DECIMAL" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="BIGINT" />
    <result column="update_time" property="updateTime" jdbcType="BIGINT" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="free_times" property="freeTimes" jdbcType="VARCHAR" />
  </resultMap>
   
<!--   <SELECT ID="GETADDRBYID" RESULTTYPE="COM.tianfang.TRAIN.POJO.TRAININGADDRESS">
  	SELECT * FROM TRAINING_ADDRESS WHERE ID = #{ID}
  </SELECT> -->
  
  <select id="getAddrById" resultType="com.tianfang.train.pojo.TrainingAddress">
  	SELECT * FROM training_address
  	<where>
  		1=1
  		<if test="id != null and id != ''">
  			AND id=#{id}
  		</if>
  	</where>
  
  </select>

    <select id="getCourseAddressesTime" resultType="com.tianfang.train.dto.TrainingCourseAddressDto" parameterType="com.tianfang.train.dto.TrainingCourseAddressDto">
	select cc.id class_id,cc.course_id,cc.price,cc.max_student,cc.actual_student,dr.id address_id,dr.district_id,dr.place,dr.address,td.id time_id,td.day_of_week,td.start_time,td.end_time 
	from training_course_class cc,training_address dr,training_time_district td 
	where   cc.address_id=dr.id and  cc.time_district_id=td.id and cc.status=1 and td.status=1 and dr.status=1  AND cc.actual_student<![CDATA[<]]>cc.max_student
	and cc.course_id=#{course_id}
	<if test="address_id != null" >
        and dr.id=#{address_id}
    </if>
  </select> 
  
  <!-- 查询所有场地的信息 -->
  <select id="getAllAddrs" resultType="com.tianfang.train.dto.TrainingAddressDtoX01">
  	SELECT id, district_id districtId, place, longtitude, latitude, address, create_time createTime, update_time updateTime, status FROM training_address;
  </select>
</mapper>